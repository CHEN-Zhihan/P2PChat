cmake_minimum_required(VERSION 2.8.9)
project(chat)
file(GLOB SOURCES "${chat_SOURCE_DIR}/src/*.c")
set(chat_BUILD_DIR "${chat_SOURCE_DIR}/build")
find_program(PYTHON "python3")
if(PYTHON)
    set(SETUP_PY_IN "${chat_SOURCE_DIR}/python/setup.py.in")
    set(SETUP_PY "${chat_BUILD_DIR}/setup.py")
    set(P2PCHAT_PY_IN "${chat_SOURCE_DIR}/python/P2PChat.py.in")
    set(P2PCHAT_PY "${chat_BUILD_DIR}/P2PChat.py")
    set(CHAT_H_IN "${chat_SOURCE_DIR}/include/chat.h.in")
    set(CHAT_H "${chat_SOURCE_DIR}/build/include/chat.h")

    set(JOINED_EXCEPTION -1)
    set(SUCCESS 0)
    set(UNJOINED_EXCEPTION -2)
    set(UNNAMED_EXCEPTION -3)

    set(OBSERVE_ADD 1)
    set(OBSERVE_REMOVE 2)
    set(OBSERVE_MESSAGE 3)
    set(OBSERVE_ERROR 4)
    set(OBSERVE_FORWARD 5)
    set(OBSERVE_BACKWARD 6)
    set(OBSERVE_LIST 7)

    configure_file(${SETUP_PY_IN} ${SETUP_PY})
    configure_file(${P2PCHAT_PY_IN} ${P2PCHAT_PY})
    configure_file(${CHAT_H_IN} ${CHAT_H})
    add_custom_target(setup ALL COMMAND ${PYTHON} ${SETUP_PY} build --build-base ${chat_BUILD_DIR} --build-lib .)
endif()
